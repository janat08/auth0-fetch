{
  "version": 3,
  "sources": ["../node_modules/cookie/index.js", "../node_modules/itty-router/dist/itty-router.min.js", "../node_modules/itty-router-extras/middleware/withContent.js", "../node_modules/itty-router-extras/middleware/withCookies.js", "../node_modules/itty-router-extras/middleware/withParams.js", "../node_modules/itty-router-extras/middleware/index.js", "../node_modules/itty-router-extras/response/createResponseType.js", "../node_modules/itty-router-extras/response/json.js", "../node_modules/itty-router-extras/response/error.js", "../node_modules/itty-router-extras/response/missing.js", "../node_modules/itty-router-extras/response/status.js", "../node_modules/itty-router-extras/response/text.js", "../node_modules/itty-router-extras/response/index.js", "../node_modules/itty-router-extras/router/ThrowableRouter.js", "../node_modules/itty-router-extras/router/index.js", "../node_modules/itty-router-extras/classes/StatusError.js", "../node_modules/itty-router-extras/classes/index.js", "../node_modules/itty-router-extras/index.js", "../node_modules/itty-durable/proxy-durable.js", "../node_modules/itty-durable/itty-durable.js", "../node_modules/itty-durable/with-durables.js", "../node_modules/itty-durable/index.js", "../auth0.js", "../durables.js", "../index.js"],
  "sourcesContent": ["/*!\n * cookie\n * Copyright(c) 2012-2014 Roman Shtylman\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nexports.parse = parse;\nexports.serialize = serialize;\n\n/**\n * Module variables.\n * @private\n */\n\nvar decode = decodeURIComponent;\nvar encode = encodeURIComponent;\nvar pairSplitRegExp = /; */;\n\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n *\n * @param {string} str\n * @param {object} [options]\n * @return {object}\n * @public\n */\n\nfunction parse(str, options) {\n  if (typeof str !== 'string') {\n    throw new TypeError('argument str must be a string');\n  }\n\n  var obj = {}\n  var opt = options || {};\n  var pairs = str.split(pairSplitRegExp);\n  var dec = opt.decode || decode;\n\n  for (var i = 0; i < pairs.length; i++) {\n    var pair = pairs[i];\n    var eq_idx = pair.indexOf('=');\n\n    // skip things that don't look like key=value\n    if (eq_idx < 0) {\n      continue;\n    }\n\n    var key = pair.substr(0, eq_idx).trim()\n    var val = pair.substr(++eq_idx, pair.length).trim();\n\n    // quoted values\n    if ('\"' == val[0]) {\n      val = val.slice(1, -1);\n    }\n\n    // only assign once\n    if (undefined == obj[key]) {\n      obj[key] = tryDecode(val, dec);\n    }\n  }\n\n  return obj;\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize the a name value pair into a cookie string suitable for\n * http headers. An optional options object specified cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n *\n * @param {string} name\n * @param {string} val\n * @param {object} [options]\n * @return {string}\n * @public\n */\n\nfunction serialize(name, val, options) {\n  var opt = options || {};\n  var enc = opt.encode || encode;\n\n  if (typeof enc !== 'function') {\n    throw new TypeError('option encode is invalid');\n  }\n\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  var value = enc(val);\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument val is invalid');\n  }\n\n  var str = name + '=' + value;\n\n  if (null != opt.maxAge) {\n    var maxAge = opt.maxAge - 0;\n\n    if (isNaN(maxAge) || !isFinite(maxAge)) {\n      throw new TypeError('option maxAge is invalid')\n    }\n\n    str += '; Max-Age=' + Math.floor(maxAge);\n  }\n\n  if (opt.domain) {\n    if (!fieldContentRegExp.test(opt.domain)) {\n      throw new TypeError('option domain is invalid');\n    }\n\n    str += '; Domain=' + opt.domain;\n  }\n\n  if (opt.path) {\n    if (!fieldContentRegExp.test(opt.path)) {\n      throw new TypeError('option path is invalid');\n    }\n\n    str += '; Path=' + opt.path;\n  }\n\n  if (opt.expires) {\n    if (typeof opt.expires.toUTCString !== 'function') {\n      throw new TypeError('option expires is invalid');\n    }\n\n    str += '; Expires=' + opt.expires.toUTCString();\n  }\n\n  if (opt.httpOnly) {\n    str += '; HttpOnly';\n  }\n\n  if (opt.secure) {\n    str += '; Secure';\n  }\n\n  if (opt.sameSite) {\n    var sameSite = typeof opt.sameSite === 'string'\n      ? opt.sameSite.toLowerCase() : opt.sameSite;\n\n    switch (sameSite) {\n      case true:\n        str += '; SameSite=Strict';\n        break;\n      case 'lax':\n        str += '; SameSite=Lax';\n        break;\n      case 'strict':\n        str += '; SameSite=Strict';\n        break;\n      case 'none':\n        str += '; SameSite=None';\n        break;\n      default:\n        throw new TypeError('option sameSite is invalid');\n    }\n  }\n\n  return str;\n}\n\n/**\n * Try decoding a string using a decoding function.\n *\n * @param {string} str\n * @param {function} decode\n * @private\n */\n\nfunction tryDecode(str, decode) {\n  try {\n    return decode(str);\n  } catch (e) {\n    return str;\n  }\n}\n", "module.exports={Router:({base:p=\"\",routes:u=[]}={})=>({__proto__:new Proxy({},{get:(e,a,o)=>(e,...r)=>u.push([a.toUpperCase(),RegExp(`^${(p+e).replace(/(\\/?)\\*/g,\"($1.*)?\").replace(/\\/$/,\"\").replace(/:(\\w+)(\\?)?(\\.)?/g,\"$2(?<$1>[^/]+)$2$3\").replace(/\\.(?=[\\w(])/,\"\\\\.\").replace(/\\)\\.\\?\\(([^\\[]+)\\[\\^/g,\"?)\\\\.?($1(?<=\\\\.)[^\\\\.\")}/*$`),r])&&o}),routes:u,async handle(e,...r){let a,o,p=new URL(e.url);e.query=Object.fromEntries(p.searchParams);for(var[t,s,c]of u)if((t===e.method||\"ALL\"===t)&&(o=p.pathname.match(s))){e.params=o.groups;for(var l of c)if(void 0!==(a=await l(e.proxy||e,...r)))return a}}})};\n", "const withContent=async t=>{let n=t.headers.get(\"content-type\");t.content=void 0;try{n&&n.includes(\"application/json\")&&(t.content=await t.json())}catch(t){}};module.exports={withContent:withContent};", "const withCookies=o=>{o.cookies={};try{o.cookies=(o.headers.get(\"Cookie\")||\"\").split(/;\\s*/).map(o=>o.split(\"=\")).reduce((o,[e,i])=>(o[e]=i,o),{})}catch(o){}};module.exports={withCookies:withCookies};", "const withParams=a=>{for(const s in a.params||{})a[s]=a.params[s]};module.exports={withParams:withParams};", "module.exports={...require(\"./withContent\"),...require(\"./withCookies\"),...require(\"./withParams\")};", "const createResponseType=(e=\"text/plain; charset=utf-8\")=>(s,t={})=>{const{headers:n={},...o}=t;return\"object\"==typeof s?new Response(JSON.stringify(s),{headers:{\"Content-Type\":e,...n},...o}):new Response(s,t)};module.exports={createResponseType:createResponseType};", "const{createResponseType:createResponseType}=require(\"./createResponseType\"),json=createResponseType(\"application/json; charset=utf-8\");module.exports={json:json};", "const{json:json}=require(\"./json\"),error=(r=500,o=\"Internal Server Error.\")=>json({...\"object\"==typeof o?o:{status:r,error:o}},{status:r});module.exports={error:error};", "const{error:error}=require(\"./error\"),missing=(r=\"Not found.\")=>error(404,r);module.exports={missing:missing};", "const{json:json}=require(\"./json\"),status=(s,t)=>t?json({...\"object\"==typeof t?t:{status:s,message:t}},{status:s}):new Response(null,{status:s});module.exports={status:status};", "const text=(e,t={})=>new Response(e,t);module.exports={text:text};", "module.exports={...require(\"./error\"),...require(\"./json\"),...require(\"./missing\"),...require(\"./status\"),...require(\"./text\")};", "\"use strict\";const{Router:Router}=require(\"itty-router\"),{error:error}=require(\"../response\"),ThrowableRouter=(r={})=>{const{stack:e=!1}=r;return new Proxy(Router(r),{get:(r,t)=>(...o)=>\"handle\"===t?r[t](...o).catch(r=>error(r.status||500,{status:r.status||500,error:r.message,stack:e&&r.stack||void 0})):r[t](...o)})};module.exports={ThrowableRouter:ThrowableRouter};", "module.exports={...require(\"./ThrowableRouter\")};", "class StatusError extends Error{constructor(r=500,t=\"Internal Error.\"){super(t),this.name=\"StatusError\",this.status=r}}module.exports={StatusError:StatusError};", "module.exports={...require(\"./StatusError\")};", "module.exports={...require(\"./middleware\"),...require(\"./response\"),...require(\"./router\"),...require(\"./classes\")};", "const{json:json,StatusError:StatusError}=require(\"itty-router-extras\"),transformResponse=t=>{try{return t.json()}catch(t){}try{return t.text()}catch(t){}return t},proxyDurable=(t,r={})=>{if(!t||!t.idFromName)throw new StatusError(500,`${r.name||\"That\"} is not a valid Durable Object binding.`);return{get:(e,o={})=>{o={...r,...o};try{\"string\"==typeof e&&(e=t.idFromName(e));const r=t.get(e),n=\"function\"==typeof o.class&&new o.class,s=t=>\"fetch\"!==t&&(!n||\"function\"==typeof n[t]),a=(t,r,e)=>new Request(`https://itty-durable/${t}/${r}`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(e)}),u=(t,r,e,n)=>{const s=t.fetch(a(r,e,n));return o.parse?s.then(transformResponse):s};return new Proxy(r,{get:(t,r)=>s(r)?(...e)=>u(t,\"call\",r,e):u(t,\"get-prop\",r),set:(t,r,e)=>u(t,\"set\",r,e)})}catch(t){throw new StatusError(500,t.message)}}}};module.exports={proxyDurable:proxyDurable};", "const{Router:Router}=require(\"itty-router\"),{error:error,json:json,withParams:withParams,withContent:withContent,StatusError:StatusError}=require(\"itty-router-extras\"),{proxyDurable:proxyDurable}=require(\"./proxy-durable\"),createIttyDurable=(t={})=>{const{persistOnChange:e=!0,alwaysReturnThis:s=!0,onError:r=(t=>error(t.status||500,t.message))}=t;return class{constructor(t={},e={}){this.state={defaultState:void 0,...e,...t},this.storage=t.storage;for(const[t,s]of Object.entries(e))this.state[t]=\"function\"==typeof s.idFromName?proxyDurable(s,{name:t,parse:!0}):s;this.router=Router();const s=new Proxy(this,{get:(t,e,s)=>\"function\"==typeof t[e]?t[e].bind(s):t[e],set:(t,e,s)=>(t[e]!==s&&(this.state.isDirty=!0),t[e]=s,!0)});return this.router.post(\"/:action/:target\",withParams,withContent,async(t,e)=>{const{action:r,target:i,content:a=[]}=t;if(\"call\"===r){if(\"function\"!=typeof this[i])throw new StatusError(500,`Durable Object ${this.constructor.name} does not contain method ${i}()`);const t=await s[i](...a);if(void 0!==t)return t instanceof Response?t:json(t)}else if(\"set\"===r)s[i]=a;else if(\"get-prop\"===r)return json(await s[i])},s.optionallyPersist,s.optionallyReturnThis),s}getPersistable(){const{state:t,storage:e,router:s,...r}=this;return r}async persist(){this.state.isDirty&&await this.storage.put(\"data\",this.getPersistable())}async loadFromStorage(){const t=await this.storage.get(\"data\")||{};Object.assign(this,t),this.state.isDirty=!1}async initialize(){this.state.initializePromise||(this.state.defaultState=JSON.stringify(this.getPersistable()),this.state.initializePromise=this.loadFromStorage().catch(t=>{throw this.state.initializePromise=void 0,t})),await this.state.initializePromise}async fetch(...t){return await this.initialize(),this.state.isDirty=!1,await this.router.handle(...t).catch(r)||error(400,\"Bad request to durable object\")}async optionallyPersist(t,s={},r={}){e&&(r.waitUntil?r.waitUntil(this.persist()):await this.persist())}reset(){for(const t in this.getPersistable())Reflect.deleteProperty(this,t);Object.assign(this,JSON.parse(this.state.defaultState))}async destroy(t={}){const{reset:e=!1}=t;await this.storage.deleteAll(),e&&this.reset()}optionallyReturnThis(){if(s)return json(this.toJSON?this.toJSON():this)}toJSON(){return this.getPersistable()}}},IttyDurable=createIttyDurable();module.exports={createIttyDurable:createIttyDurable,IttyDurable:IttyDurable};", "const{proxyDurable:proxyDurable}=require(\"./proxy-durable\"),{StatusError:StatusError,json:json}=require(\"itty-router-extras\"),isDurable=r=>\"function\"==typeof r.idFromName,withDurables=(r={})=>(e,s)=>{const{parse:t=!1,classes:o={}}=r;e.durables=e.durables||{};for(const[r,t]of Object.entries(s))if(isDurable(t)){const s=proxyDurable(t,{name:r,class:o[r]});try{e[r]=e.durables[r]=s}catch(e){throw new StatusError(500,`Could not set Durable binding \"${r}\" on Request`)}}};module.exports={withDurables:withDurables};", "module.exports={...require(\"./itty-durable\"),...require(\"./with-durables\"),...require(\"./proxy-durable\")};", "import cookie from 'cookie'\n\nimport { proxyDurable } from 'itty-durable'\nexport const cookieKey = 'AUTH0-AUTH'\n\nexport function globals({kv, MODE, ...env}, request2){\nconst {SESSION, STATE} = env\nconst SEDO = proxyDurable(SESSION)\nconst STDO = proxyDurable(STATE)\nconst AUTH_STORE = kv\nconst devBase = env.AUTHREDIRECT\nconst callbackBase = MODE != 'production'? devBase : env.AUTHREDIRECTPRODUCTION\nconst auth0 = {\n  domain: env.AUTH0DOMAIN,\n  clientId: env.AUTH0ID,\n  clientSecret: env.AUTH0SECRET,\n  callbackUrl: callbackBase + \"/auth\",\n}\n\nconst AUTH0_DOMAIN = \"https://\" + auth0.domain \nconst AUTH0_CLIENT_ID = auth0.clientId\nconst generateStateParam = async () => {\n  const resp = await fetch('https://csprng.xyz/v1/api')\n  const { Data: state } = await resp.json()\n  const nada= await request2.STATE.get(`state-${state}`).set({url: request2.url, created:true}).then(x=>x.json())\n  console.log('1.11', state, nada, request2.url)\n  return state \n}\n\nconst exchangeCode = async code => {\n  const body = JSON.stringify({\n    grant_type: 'authorization_code',\n    client_id: auth0.clientId,\n    client_secret: auth0.clientSecret,\n    code,\n    redirect_uri: auth0.callbackUrl,\n  })\n  const res = await fetch(AUTH0_DOMAIN + '/oauth/token', {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body,\n  })\n  // console.log(res)\n  return persistAuth(\n    res\n  )\n}\n\n// https://github.com/pose/webcrypto-jwt/blob/master/index.js\nconst decodeJWT = function(token) {\n  var output = token\n    .split('.')[1]\n    .replace(/-/g, '+')\n    .replace(/_/g, '/')\n  switch (output.length % 4) {\n    case 0:\n      break\n    case 2:\n      output += '=='\n      break\n    case 3:\n      output += '='\n      break\n    default:\n      throw 'Illegal base64url string!'\n  }\n\n  const result = atob(output)\n\n  try {\n    return decodeURIComponent(escape(result))\n  } catch (err) {\n    console.log(err)\n    return result\n  }\n}\n\nconst validateToken = token => {\n  try {\n    const dateInSecs = d => Math.ceil(Number(d) / 1000)\n    const date = new Date()\n\n    let iss = token.iss\n\n    // ISS can include a trailing slash but should otherwise be identical to\n    // the AUTH0_DOMAIN, so we should remove the trailing slash if it exists\n    iss = iss.endsWith('/') ? iss.slice(0, -1) : iss\n\n    if (iss !== AUTH0_DOMAIN) {\n      throw new Error(\n        `Token iss value (${iss}) doesn't match AUTH0_DOMAIN (${AUTH0_DOMAIN})`,\n      )\n    }\n\n    if (token.aud !== AUTH0_CLIENT_ID) {\n      throw new Error(\n        `Token aud value (${token.aud}) doesn't match AUTH0_CLIENT_ID (${AUTH0_CLIENT_ID})`,\n      )\n    }\n\n    if (token.exp < dateInSecs(date)) {\n      throw new Error(`Token exp value is before current time`)\n    }\n\n    // Token should have been issued within the last day\n    date.setDate(date.getDate() - 1)\n    if (token.iat < dateInSecs(date)) {\n      throw new Error(`Token was issued before one day ago and is now invalid`)\n    }\n\n    return true\n  } catch (err) {\n    console.log(err.message)\n    return false\n  }\n}\n\nconst persistAuth = async exchange => {\n  const body = await exchange.json()\n\n  if (body.error) {\n    console.log('err', body)\n    throw new Error(body.error)\n  }\n\n  const date = new Date()\n  date.setDate(date.getDate() + 1)\n\n  const decoded = JSON.parse(decodeJWT(body.id_token))\n  const validToken = validateToken(decoded)\n  if (!validToken) {\n    return { status: 401 }\n  }\n\n  const text = new TextEncoder().encode(`${env.SALT}-${decoded.sub}`)\n  const digest = await crypto.subtle.digest({ name: 'SHA-256' }, text)\n  const digestArray = new Uint8Array(digest)\n  const id = btoa(String.fromCharCode.apply(null, digestArray))\n\n  await request2.SESSION.get(id).set(JSON.stringify(body))\n\n  \n  const cookieHeader = request2.headers.get('Cookie')\n  // if (cookieHeader && cookieHeader.includes('loginRedirect')) {\n    const cookies = cookie.parse(cookieHeader)\n    let path = cookies['loginRedirect']\n    console.log('cookies', 33333, path, cookies)\n  const headers = {\n    Location: path,\n    'Set-cookie': `${cookieKey}=${id}; Secure; HttpOnly; SameSite=Lax; Expires=${date.toUTCString()}`,\n  }\n\n  return { headers, status: 302 }\n}\n\nconst redirectUrl = state =>\n  `${auth0.domain}/authorize?response_type=code&client_id=${\n    auth0.clientId\n  }&redirect_uri=${\n    auth0.callbackUrl\n  }&scope=openid%20profile%20email&state=${encodeURIComponent(state)}`\n\n const handleRedirect = async request => {\n  const url = new URL(request.url)\n\n  const state = url.searchParams.get('state')\n  if (!state) {\n    return null\n  }\n\n  //TODO\n  console.log(1.1)\n  const storedState = await request2.STATE.get(`state-${state}`).toJSON().then(x=>x.json()).then(x=>x.origin)\n  console.log(1.2, 'slow?', storedState, state)\n  if (!storedState.created) {\n    console.log(3)\n    return null\n  }\n\n  const code = url.searchParams.get('code')\n  \n  if (code) {\n    console.log(4, code, url)\n    return exchangeCode(code)\n  }\n  console.log(2)\n\n  return null\n}\n\nconst verify = async request => {\n  const cookieHeader = request.headers.get('Cookie')\n  if (cookieHeader && cookieHeader.includes(cookieKey)) {\n    const cookies = cookie.parse(cookieHeader)\n    if (!cookies[cookieKey]) return {}\n    const sub = cookies[cookieKey]\n    const {session: kvData} = await request2.SESSION.get(sub).toJSON().then(x=>x.json())\n   \n    \n    if (!kvData) {\n      throw new Error('Unable to find authorization data')\n    }\n\n    let kvStored\n    try {\n      kvStored = JSON.parse(kvData)\n    } catch (err) {\n      throw new Error('Unable to parse auth information from Workers KV', err)\n    }\n\n    const { access_token: accessToken, id_token: idToken } = kvStored\n    const userInfo = JSON.parse(decodeJWT(idToken))\n    return { accessToken, idToken, userInfo }\n  }\n  return {}\n}\n\n const authorize = async event => {\n  const authorization = await verify(event)\n  if (authorization.accessToken) {\n    return [true, { authorization }]\n  } else {\n    const state = await generateStateParam()\n    return [false, { redirectUrl: redirectUrl(state) }]\n  }\n}\n\n const logout = request => {\n  const cookieHeader = request.headers.get('Cookie')\n  if (cookieHeader && cookieHeader.includes(cookieKey)) {\n\n    return {\n      headers: {\n        'Location': `https://${auth0.domain}/v2/logout?client_id=${\n          auth0.clientId}&returnTo=${\n          callbackBase\n          }`,\n        'Set-cookie': `${cookieKey}=\"\"; HttpOnly; Secure; SameSite=Lax;Path=/;`,\n      },\n    }\n  }\n  console.log(\"didnt logout, no cookie found\")\n  return {}\n}\nreturn {logout, cookieKey, authorize, handleRedirect}\n}", "import { IttyDurable } from 'itty-durable'\n\nexport class State extends IttyDurable {\n    constructor(state, env) {\n      super(state, env)\n      this.origin= {created: false, url: '/'}\n    //   this.state=state\n    // //   this.state.blockConcurrencyWhile(async () => {\n    // //     let stored = await this.state.storage.get(\"origin\");\n    // //     this.origin = stored || '/';\n    // // })\n    }\n  \n    set(o) {\n      // this.state.storage.put('origin', o)\n      console.log('url',99999, new URL(o.url))\n      try {\n      const url = new URL(o.url)\n      o.url = url.pathname + url.search\n      console.log('new url', o.url)\n      if (o.url == '/login'){\n        o.url = '/'\n      }\n      \n      this.origin = o\n      return o\n      } catch (e){\n        console.log(e)\n        \n      }\n    }\n\n    read(){\n      return this.origin\n    }\n  }\n\n  export class Session extends IttyDurable {\n    constructor(state, env) {\n      super(state, env)\n      this.session = 0\n      // this.state = state\n      // this.state.blockConcurrencyWhile(async () => {\n      //   let stored = await this.state.storage.get(\"session\");\n      //   this.session = stored || null;\n    // })\n    }\n  \n    set(o) {\n      // this.state.storage.put('session', o)\n      this.session = o\n    }\n    read(){\n      return this.session\n    }\n  }", "// import { getAssetFromKV } from '@cloudflare/kv-asset-handler'\n\n//import { authorize as makeAuth, logout, handleRedirect, cookieKey } from './auth0'\nimport { globals, cookieKey } from './auth0'\nimport {Session, State} from './durables.js'\nexport {Session, State}\nimport cookie from 'cookie'\n\n// see the readme for more info on what these config options do!\nconst config = {\n  // opt into automatic authorization state hydration\n  hydrateState: false,\n  // return responses at the edge\n  originless: false,\n}\n\nexport function authorizedCookie(event){\n  const cookieHeader = event.headers.get('Cookie')\n  if (cookieHeader && cookieHeader.includes(cookieKey)) {\n    const cookies = cookie.parse(cookieHeader)\n    if (cookies[cookieKey] != '') return true\n  }\n  return false\n}\n\n//point of this is to have a function  that doesnt demand user be logged in, unlike for navbar profile button for example\nexport function authorized(event, env){\n  return authorize(event, env, true)\n}\n\n//event is actually request\nexport async function authorize(event, env, verifyOnly=false) {\nconst {MODE} = env\nconst { authorize: makeAuth, logout, handleRedirect} = globals(env, event)\n\n  const stubs = {\n    user: {\n        authorization: {\n            userInfo: {\n                sub: 'testSubId'\n            }\n          },\n          authorized: true\n    }\n  }\n  const isTest = MODE == 'test'\n  if (isTest) return stubs.user\n\n  try {\n    //original coded expected worker event\n    //and wanted non-worktop event\n    // let {body, ...other} = event\n    // let request = new Request(event.url, {\n    // //   ...event, body: await event.body()})\n    // // request = new Request(event.url, {\n    //     ...other})\n        \n    // event = request\n    let request = event\n    console.log('makeauth',)\n    const [authorized, { authorization, redirectUrl }] = await makeAuth(event)\n    console.log('stuck makeauth?')\n    if (authorized && authorization.accessToken) {\n      \n      request = new Request(request, {\n        headers: {\n          Authorization: `Bearer ${authorization.accessToken}`,\n        },\n      })\n    }\n \n    let response = new Response(null)\n    const url = new URL(request.url)\n    console.log('auth')\n    if (url.pathname === '/auth') {\n      const authorizedResponse = await handleRedirect(event)\n\n      if (!authorizedResponse) {\n        return new Response('Unauthorized', { status: 401 })\n      }\n      console.log(authorizedResponse, response.body)\n      response = new Response(response.body, {\n        response,\n        ...authorizedResponse,\n      })\n\n      return response\n    }\n    console.log('authorize redirect')\n    if (!authorized && !verifyOnly) {\n      console.log('redirect', redirectUrl)\n      const url = new URL(event.url)\n      let path = url.pathname + url.search\n      if (path == '/login'){\n        path = '/'\n      }\n      console.log('setting cookie', 33333, path)\n      return new Response('', {\n        status: 302,\n        headers: {\n          'Location': 'https://' + redirectUrl,\n          'Set-cookie': `loginRedirect=\"${path}\"; HttpOnly; Secure; SameSite=Lax; Path=/`,\n        },\n      })\n    }\n\n    const logoutHeaders = {'Location': '/'}\n\n    if (url.pathname === '/logout') {\n      const { headers } = logout(event)\n      const merged = Object.assign({}, logoutHeaders, headers)\n      console.log(merged)\n      return new Response(response.body, {\n            status: 302,\n            headers: merged\n          })\n    }\n    \n    return  {authorized, authorization}\n  } catch (err) {\n    console.log(err)\n    return new Response(err.toString())\n  }\n}"],
  "mappings": "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",
  "names": []
}
